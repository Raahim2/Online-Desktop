<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alien Language Decryption Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Minor style tweaks if absolutely needed */
        /* Add a subtle glow effect to text */
        .text-glow {
            text-shadow: 0 0 5px currentColor, 0 0 10px currentColor;
        }
        /* Custom scrollbar for aesthetics (optional, WebKit only) */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937; /* gray-800 */
        }
        ::-webkit-scrollbar-thumb {
            background-color: #10b981; /* emerald-500 */
            border-radius: 4px;
            border: 2px solid #1f2937; /* gray-800 */
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: #059669; /* emerald-600 */
        }
        /* Ensure textareas maintain mono font */
        textarea {
            font-family: inherit;
        }
    </style>
</head>
<body class="bg-gray-900 text-green-400 font-mono flex flex-col min-h-screen">

    <header class="bg-gray-800/50 backdrop-blur-sm border-b border-green-700/30 shadow-lg sticky top-0 z-10">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <h1 class="text-xl md:text-2xl font-bold text-glow">
                <span class="text-cyan-400">Xylar</span><span class="text-gray-400">-OS</span> // Decryption Interface v1.7
            </h1>
            <div class="text-xs text-gray-500">Status: <span class="text-green-500">Online</span></div>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8">

            <!-- Left Column: Encrypted Message & Logs -->
            <div class="lg:col-span-1 flex flex-col gap-6 md:gap-8">
                <!-- Encrypted Message -->
                <section class="bg-gray-800/60 p-4 rounded-lg border border-cyan-600/30 shadow-md">
                    <h2 class="text-lg font-semibold mb-3 text-cyan-400 border-b border-cyan-600/30 pb-2">Incoming Transmission Fragment</h2>
                    <div id="encryptedMessage" class="w-full h-48 bg-gray-900 p-3 rounded border border-gray-700 overflow-auto text-sm leading-relaxed text-yellow-300/80">
                        <p>§Ψ∇⊕⁂ ЖЖ ∰∇ Ψ⊕§⁂ ∰∇ ∞± ∓∞ ЖЖ §Ψ∇⊕⁂</p>
                        <p>Ψ⊕§⁂ ЖЖ ∰∇ §Ψ∇⊕⁂ ∞± ∓∞ ∰∇ ЖЖ §Ψ∇⊕⁂</p>
                        <p>∰∇ §Ψ∇⊕⁂ ∞± ∓∞ ЖЖ Ψ⊕§⁂ ∰∇ §Ψ∇⊕⁂</p>
                        <p>ЖЖ §Ψ∇⊕⁂ ∰∇ ∞± ∓∞ §Ψ∇⊕⁂ ЖЖ ∰∇ Ψ⊕§⁂</p>
                        <p>∞± ∓∞ §Ψ∇⊕⁂ ∰∇ ЖЖ Ψ⊕§⁂ ∰∇ §Ψ∇⊕⁂</p>
                        <p>§Ψ∇⊕⁂ ЖЖ ∰∇ Ψ⊕§⁂ ∞± ∓∞ ∰∇ §Ψ∇⊕⁂</p>
                    </div>
                    <div class="mt-3 text-right text-xs text-gray-500">Source: Sector Gamma-7 | Signal Strength: 87.4%</div>
                </section>

                <!-- System Log -->
                <section class="bg-gray-800/60 p-4 rounded-lg border border-green-600/30 shadow-md flex-grow flex flex-col">
                    <h2 class="text-lg font-semibold mb-3 text-green-400 border-b border-green-600/30 pb-2">System Log</h2>
                    <div id="logArea" class="w-full h-64 bg-gray-900 p-3 rounded border border-gray-700 overflow-auto text-xs flex-grow flex flex-col-reverse">
                        <!-- Log messages will be added here by JS -->
                        <p class="text-gray-500">[...]</p>
                        <p class="text-gray-400"><span class="text-gray-600">[14:38:01]</span> Interface Initialized. Standby for analysis.</p>
                        <p class="text-yellow-400"><span class="text-gray-600">[14:37:55]</span> Warning: Unstable chroniton field detected nearby.</p>
                        <p class="text-cyan-400"><span class="text-gray-600">[14:37:50]</span> Received encrypted fragment TR-771.</p>
                    </div>
                </section>
            </div>

            <!-- Right Column: Decryption Workspace -->
            <div class="lg:col-span-2 flex flex-col gap-6 md:gap-8">
                <!-- Symbol Mapping -->
                <section class="bg-gray-800/60 p-4 rounded-lg border border-gray-600/30 shadow-md">
                    <h2 class="text-lg font-semibold mb-3 text-gray-300 border-b border-gray-600/30 pb-2">Symbol Mapping Matrix</h2>
                    <div class="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-3">
                        <!-- Example Symbol Mapping Entries -->
                        <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">§</div>
                            <input type="text" maxlength="1" id="map-s1" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s1', this.value)">
                        </div>
                        <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">Ψ</div>
                            <input type="text" maxlength="1" id="map-s2" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s2', this.value)">
                        </div>
                         <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">∇</div>
                            <input type="text" maxlength="1" id="map-s3" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s3', this.value)">
                        </div>
                         <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">⊕</div>
                            <input type="text" maxlength="1" id="map-s4" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s4', this.value)">
                        </div>
                         <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">⁂</div>
                            <input type="text" maxlength="1" id="map-s5" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s5', this.value)">
                        </div>
                         <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">Ж</div>
                            <input type="text" maxlength="1" id="map-s6" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s6', this.value)">
                        </div>
                         <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">∰</div>
                            <input type="text" maxlength="1" id="map-s7" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s7', this.value)">
                        </div>
                         <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">∞</div>
                            <input type="text" maxlength="1" id="map-s8" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s8', this.value)">
                        </div>
                         <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">±</div>
                            <input type="text" maxlength="1" id="map-s9" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s9', this.value)">
                        </div>
                         <div class="bg-gray-700/50 p-2 rounded border border-gray-600 text-center">
                            <div class="text-xl text-yellow-300">∓</div>
                            <input type="text" maxlength="1" id="map-s10" class="mt-1 w-8 h-8 text-center bg-gray-900 border border-gray-700 rounded text-green-400 focus:ring-1 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none uppercase" placeholder="?" oninput="updateMapping('s10', this.value)">
                        </div>
                        <!-- Add more symbols as needed -->
                        <div class="bg-gray-900/30 p-2 rounded border border-dashed border-gray-700 text-center flex items-center justify-center">
                            <span class="text-gray-600 text-2xl">+</span>
                        </div>
                    </div>
                </section>

                <!-- Decryption Output -->
                <section class="bg-gray-800/60 p-4 rounded-lg border border-gray-600/30 shadow-md flex-grow flex flex-col">
                    <h2 class="text-lg font-semibold mb-3 text-gray-300 border-b border-gray-600/30 pb-2">Decryption Attempt</h2>
                    <textarea id="decryptedOutput" class="w-full h-48 md:h-64 lg:h-auto flex-grow bg-gray-900 p-3 rounded border border-gray-700 text-green-300 focus:ring-1 focus:ring-green-500 focus:border-green-500 focus:outline-none text-sm leading-relaxed" placeholder="Decryption output based on current mapping will appear here..."></textarea>
                </section>

                <!-- Controls -->
                <section class="bg-gray-800/60 p-4 rounded-lg border border-gray-600/30 shadow-md">
                    <h2 class="text-lg font-semibold mb-3 text-gray-300 border-b border-gray-600/30 pb-2">Controls</h2>
                    <div class="flex flex-wrap gap-3">
                        <button id="analyzeButton" onclick="analyzeTransmission()" class="px-4 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-md shadow transition duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-cyan-500">
                            Analyze Pattern
                        </button>
                        <button id="applyMapButton" onclick="applyMapping()" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md shadow transition duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-green-500">
                            Apply Mapping
                        </button>
                         <button id="resetMapButton" onclick="resetMapping()" class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-md shadow transition duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-yellow-500">
                            Reset Mapping
                        </button>
                        <button id="submitButton" onclick="submitDecryption()" class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md shadow transition duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-red-500 ml-auto">
                            Submit Decryption
                        </button>
                    </div>
                </section>
            </div>

        </div>
    </main>

    <footer class="bg-gray-800/50 border-t border-green-700/30 mt-8 shadow-inner">
        <div class="container mx-auto px-4 py-3 text-center text-xs text-gray-500">
            &copy; 2342 Galactic Federation - Xenolinguistics Division. Unauthorized access prohibited.
        </div>
    </footer>

    <script>
        const logArea = document.getElementById('logArea');
        const decryptedOutput = document.getElementById('decryptedOutput');
        const encryptedMessageDiv = document.getElementById('encryptedMessage');
        const encryptedText = encryptedMessageDiv ? encryptedMessageDiv.innerText : ''; // Get initial encrypted text

        // Store symbol mappings (simple object for demo)
        const symbolMap = {};

        function logMessage(message, type = 'info') {
            if (!logArea) return;
            const timestamp = new Date().toLocaleTimeString();
            const newLogEntry = document.createElement('p');

            let colorClass = 'text-gray-400'; // Default info
            if (type === 'success') colorClass = 'text-green-400';
            if (type === 'warning') colorClass = 'text-yellow-400';
            if (type === 'error') colorClass = 'text-red-400';
            if (type === 'system') colorClass = 'text-cyan-400';

            newLogEntry.className = `${colorClass}`;
            newLogEntry.innerHTML = `<span class="text-gray-600">[${timestamp}]</span> ${message}`;

            // Insert new message at the top (visually bottom due to flex-col-reverse)
            logArea.insertBefore(newLogEntry, logArea.firstChild);

            // Limit log entries (optional)
            const maxLogEntries = 50;
            if (logArea.children.length > maxLogEntries) {
                 logArea.removeChild(logArea.lastChild);
            }
        }

        function updateMapping(symbolId, letter) {
            const inputElement = document.getElementById(`map-${symbolId}`);
            const symbol = inputElement.previousElementSibling.textContent; // Get the symbol text
            const upperCaseLetter = letter.toUpperCase();

            if (inputElement) {
                 inputElement.value = upperCaseLetter; // Ensure uppercase display
            }

            if (upperCaseLetter && /^[A-Z0-9?]$/.test(upperCaseLetter)) { // Allow letters, numbers, or '?'
                symbolMap[symbol] = upperCaseLetter === '?' ? null : upperCaseLetter; // Store mapping, null if '?'
                logMessage(`Mapping updated: ${symbol} -> ${upperCaseLetter === '?' ? '(cleared)' : upperCaseLetter}`, 'system');
            } else if (upperCaseLetter === '') {
                 symbolMap[symbol] = null; // Clear mapping if input is empty
                 logMessage(`Mapping cleared for: ${symbol}`, 'system');
            } else {
                // Invalid input, maybe clear or ignore
                if (inputElement) inputElement.value = ''; // Clear invalid input
                symbolMap[symbol] = null;
                logMessage(`Invalid mapping input for ${symbol}. Cleared.`, 'warning');
            }
             // Optionally, trigger applyMapping automatically on input
             // applyMapping();
        }

        function applyMapping() {
            if (!decryptedOutput || !encryptedText) return;

            let result = '';
            for (let i = 0; i < encryptedText.length; i++) {
                const char = encryptedText[i];
                // Check if the character is one of the mapped symbols
                if (symbolMap.hasOwnProperty(char)) {
                    result += symbolMap[char] ? symbolMap[char] : '?'; // Use mapped letter or '?' if mapped to null/? or not mapped yet
                } else {
                    result += char; // Keep original character (like spaces, newlines)
                }
            }
            decryptedOutput.value = result;
            logMessage('Current mapping applied to output.', 'success');
        }

        function resetMapping() {
            // Clear the internal map object
            for (const key in symbolMap) {
                delete symbolMap[key];
            }
            // Clear the input fields
            const inputs = document.querySelectorAll('input[id^="map-"]');
            inputs.forEach(input => input.value = '');
            // Clear the output area
            if (decryptedOutput) decryptedOutput.value = '';
            logMessage('Symbol mapping and output cleared.', 'warning');
        }

        function analyzeTransmission() {
            logMessage('Initiating frequency analysis...', 'system');
            // Simulate analysis delay
            setTimeout(() => {
                // Example: Find most frequent symbol in the placeholder text
                const symbolCounts = {};
                const symbols = Object.keys(symbolMap); // Use currently known symbols from the grid
                 if (encryptedText) {
                    for(let i=0; i<encryptedText.length; i++) {
                        const char = encryptedText[i];
                        if (symbols.includes(char)) { // Only count known alien symbols
                            symbolCounts[char] = (symbolCounts[char] || 0) + 1;
                        }
                    }
                 }

                let mostFrequent = '?';
                let maxCount = 0;
                for (const symbol in symbolCounts) {
                    if (symbolCounts[symbol] > maxCount) {
                        maxCount = symbolCounts[symbol];
                        mostFrequent = symbol;
                    }
                }

                if (mostFrequent !== '?') {
                     logMessage(`Analysis complete. Most frequent symbol: ${mostFrequent} (appears ${maxCount} times). Suggest mapping to 'E' or 'T'.`, 'success');
                } else {
                     logMessage(`Analysis complete. No dominant symbols detected in current fragment.`, 'info');
                }

            }, 1500);
        }

         function submitDecryption() {
            const currentDecryption = decryptedOutput ? decryptedOutput.value : '';
            if (currentDecryption.trim() === '' || currentDecryption.includes('?')) {
                 logMessage('Submission failed: Decryption incomplete or contains unknown symbols.', 'error');
                 alert('Submission Failed!\nPlease complete the symbol mapping before submitting.');
            } else {
                 logMessage('Decryption submitted for verification.', 'success');
                 alert('Decryption Submitted!\nVerification pending...');
                 // Here you would typically send the data somewhere
            }
         }

        // Initial log message on load
        document.addEventListener('DOMContentLoaded', () => {
             logMessage('Xylar-OS Decryption Interface v1.7 online.', 'system');
             // Populate initial symbolMap from placeholders if needed, or leave empty
             const inputs = document.querySelectorAll('input[id^="map-"]');
             inputs.forEach(input => {
                 const symbol = input.previousElementSibling.textContent;
                 symbolMap[symbol] = null; // Initialize all known symbols as unmapped
             });
             logMessage(`Loaded ${Object.keys(symbolMap).length} known symbols. Awaiting mapping input.`, 'info');
        });

    </script>

</body>
</html>